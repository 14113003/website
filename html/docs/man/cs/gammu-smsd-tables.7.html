<div class="manpage">
<h2>GAMMU-SMSD-TABLES</h2>
Section: Dokumentace Gammu (7)<br/>
Updated: Srpen 17, 2009<br/>
<a href="#index">Index</a> 
<hr/>
<a class="aname" id="lbAB" name="lbAB"/>
<h3>JMÉNO</h3>
<p>gammu-smsd-tables - popis tabulek pro databázové služby <a href="../gammu-smsd.1/">gammu-smsd</a>(1)</p>
<p><a class="aname" id="lbAC" name="lbAC"/></p>
<h3>POPIS</h3>
<a href="../gammu-smsd.1/">gammu-smsd</a>(1) podporuje několik
služeb. Aktuálně použitá je zvolená v konfiguračním souboru
<a href="../gammu-smsdrc.5/">gammu-smsdrc</a>(5).
<p>Jednotlivé služby jsou popsány v samostatných manuálových
stránkách. Tato manuálová stránka popisuje strukturu databáze a
potřebné tabulky.</p>
<p>Několik SMS démonů může sdílet jedinou databázi. Pokud v jejich
nastavení nezadáte PhoneID, všechny jsou brány jako rovnocenné a
kterýkoliv z nich může odeslat odchozí zprávu. Pokud nastavíte
PhoneID a použijete ho při vkládání zprávy to tabulky outbox
(<a href="../gammu-smsd-inject.1/">gammu-smsd-inject</a>(1) to
dělá), každý SMS démon bude mít vlastní frontu odchozích zpráv.</p>
<p><a class="aname" id="lbAD" name="lbAD"/></p>
<h4>Přijímání zpráv</h4>
<p>Přijaté zprávy jsou ukládány v tabulce inbox.</p>
<p><a class="aname" id="lbAE" name="lbAE"/></p>
<h4>Odesílání zpráv</h4>
<p>Zprávy k odeslání jsou čteny z tabulky outbox a jejich případné
další části z tabulky outbox_multipart.</p>
<p><a class="aname" id="lbAF" name="lbAF"/></p>
<h4>Popis tabulek</h4>
<dl compact="compact">
<dt><b>daemons</b></dt>
<dd>
<p>Informace o běžících démonech.</p>
</dd>
<dt><b>gammu</b></dt>
<dd>
<p>Tato tabulka obsahuje jedinou hodnotu - verzi databázového
schématu. V části HISTORIE se můžete podívat, co se měnilo.</p>
</dd>
<dt><b>inbox</b></dt>
<dd>
<p>Tabulka, ve které jsou ukládány přijaté zprávy.</p>
<p>Popis sloupců:</p>
<p><b>UpdatedInDB</b> (timestamp)<br/>
kdy byl tento záznam aktualizován</p>
<p><b>ReceivingDateTime</b> (timestamp)<br/>
kdy byla přijata SMS</p>
<p><b>Text</b> (text)<br/>
zakódovaný text zprávy (pro všechny SMS)</p>
<p><b>SenderNumber</b> (varchar(20))<br/>
číslo odesílatele SMS</p>
<p><b>Coding</b> (enum('Default_No_Compression',
'Unicode_No_Compression', '8bit', 'Default_Compression',
'Unicode_Compression'))<br/>
kódování textu SMS</p>
<p><b>UDH</b> (text)<br/>
zakódovaná hlavička uživatelských dat (UDH)</p>
<p><b>SMSCNumber</b> (varchar(20))<br/>
číslo centra zpráv (SMSC)</p>
<p><b>Class</b> (integer)<br/>
třída SMS nebo -1 (0 je jen pro zobrazení na displej, 1 je normální
SMS)</p>
<p><b>TextDecoded</b> (varchar(160))<br/>
dekódovaný text (pro zprávy ve výchozí abecedě nebo unicode)</p>
<p><b>ID</b> (integer unsigned)<br/>
identifikátor zprávy (pro použití v externích aplikacích)</p>
<p><b>RecipientID</b> (text)<br/>
který démon Gammu přidal tento záznam</p>
<p><b>Processed</b> (enum('false', 'true'))<br/>
můžete použít pro označení, jestli byla zpráva zpracována nebo
nebyla</p>
</dd>
<dt><b>outbox</b></dt>
<dd>
<p>Zprávy určené k odeslání by měly být uloženy v této tabulce.
Pokud zpráva obsahuje více částí, další části jsou uloženy v
tabulce outbox_multipart.</p>
<p>Popis sloupců:</p>
<p><b>UpdatedInDB</b> (timestamp)<br/>
kdy byl tento záznam aktualizován</p>
<p><b>InsertIntoDB</b> (timestamp)<br/>
kdy byla zpráva vložena do databáze</p>
<p><b>SendingDateTime</b> (timestamp)<br/>
nastavte na libovolnou hodnotu, pokud chcete vynutit poslání zprávy
i po naplánovaném čase</p>
<p><b>Text</b> (text)<br/>
Text SMS zakódovaný šestnáctkově ve správné znakové sadě. Pokud
chcete použít pole TextDecoded, nechte zde NULL (nebo prázdný
text).</p>
<p><b>DestinationNumber</b> (varchar(20))<br/>
číslo příjemce</p>
<p><b>Coding</b> (enum('Default_No_Compression',
'Unicode_No_Compression', '8bit', 'Default_Compression',
'Unicode_Compression'))<br/>
kódování textu SMS</p>
<p><b>UDH</b> (text)<br/>
User Data Header ((hlavička uživatelských dat) zapsaná v
šestnáckové soustavě, která bude použita při vytváření zprávy.
Pokud není uvedena, zpráva bude odeslána jako čistě textová.</p>
<p><b>Class</b> (integer)<br/>
třída SMS nebo -1 (0 je normální SMS, 1 jen pro zobrazení na
displej)</p>
<p><b>TextDecoded</b> (varchar(160))<br/>
text zprávy v &quot;člověkem čitelné&quot; podobě</p>
<p><b>ID</b> (integer unsigned)<br/>
číslo SMS/SMS sekvence</p>
<p>Prosím uvědomte si, že toto číslo musí být unikátní i pro
tabulku sentitems, takže opětovné používání ID zpráv nemusí být
nutně dobrý nápad.</p>
<p><b>MultiPart</b> (enum('false','true'))<br/>
informace, zda se v tabulce outbox_multipart nacházejí další části
této SMS zprávy</p>
<p><b>RelativeValidity</b> (integer)<br/>
platnost SMS zakódovaná podle GSM specifikací</p>
<p><b>SenderID</b> (text)<br/>
která instance SMSD by měla odesílat tuto sekvenci</p>
<p><b>SendingTimeOut</b> (timestamp)<br/>
použito SMSD pro vlastní účely</p>
<p><b>DeliveryReport</b> (enum('default','yes','no'))<br/>
při výchozí hodnotě bude nastavení doručenky záviset na nastavení
SMSD, při yes se doručenka vynutí</p>
<p><b>CreatorID</b> (text)<br/>
identifikace odesílajícího démona, musí odpovídat PhoneID v
konfiguraci SMSD, aby SMSD zprávu zpracoval</p>
</dd>
<dt><b>outbox_multipart</b></dt>
<dd>
<p>Data pro odchozí zprávy, které jsou z více částí.</p>
<p>Popis sloupců:</p>
<p><b>ID</b> (integer unsigned)<br/>
<b>Text</b> (text)<br/>
<b>Coding</b> (enum('Default_No_Compression',
'Unicode_No_Compression', '8bit', 'Default_Compression',
'Unicode_Compression'))<br/>
<b>UDH</b> (text)<br/>
<b>Class</b> (integer)<br/>
<b>TextDecoded</b> (varchar(160))<br/>
<b>ID</b> (integer unsigned)<br/>
mají stejný význam jako v tabulce outbox</p>
<p><b>SequencePosition</b> (integer)<br/>
kolikátá zpráva je tato v SMS sekvenci (začíná se od 2, první část
je uložena v tabulce outbox).</p>
</dd>
<dt><b>phones</b></dt>
<dd>
<p>Informace o připojených telefonech. Tato tabulka je pravidelně
obnovována a můžete v ní najít informace jako stav baterie nebo
síla signálu.</p>
<p>Popis sloupců:</p>
<p><b>ID</b> (text)<br/>
hodnota PhoneID</p>
<p><b>UpdatedInDB</b> (timestamp)<br/>
kdy byl tento záznam aktualizován</p>
<p><b>InsertIntoDB</b> (timestamp)<br/>
kdy byl tento záznam vytvořen (kdy byl telefon připojen)</p>
<p><b>TimeOut</b> (timestamp)<br/>
kdy tento záznam expiruje</p>
<p><b>Send</b> (boolean)<br/>
v současné době vždy true</p>
<p><b>Receive</b> (boolean)<br/>
v současné době vždy true</p>
<p><b>IMEI</b> (text)<br/>
IMEI telefonu</p>
<p><b>Client</b> (text)<br/>
jméno klienta, obvykle text Gammu a verze</p>
<p><b>Battery</b> (integer)<br/>
stav baterie v procentech (nebo -1 pokud není znám)</p>
<p><b>Signal</b> (integer)<br/>
úrověň signálu v procentech (nebo -1 pokud není znám)</p>
<p><b>Sent</b> (integer)<br/>
Počet odeslaných SMS zpráv (SMSD tento čítač nenuluje, takže může
přetéct).</p>
<p><b>Received</b> (integer)<br/>
Počet přijatých SMS zpráv (SMSD tento čítač nenuluje, takže může
přetéct).</p>
</dd>
<dt><b>sentitems</b></dt>
<dd>
<p>Informace o odeslaných (a neodeslaných) zprávách a jejich stavu.
Při zapnutých doručenkách je stav zprávy aktualizován při jejím
přijetí.</p>
<p>Popis sloupců:</p>
<p><b>UpdatedInDB</b> (timestamp)<br/>
kdy byl tento záznam aktualizován</p>
<p><b>InsertIntoDB</b> (timestamp)<br/>
kdy byla zpráva vložena do databáze</p>
<p><b>SendingDateTime</b> (timestamp)<br/>
kdy byla zpráva odeslána</p>
<p><b>DeliveryDateTime</b> (timestamp)<br/>
Čas přijetí doručenky (pokud jsou zapnuty).</p>
<p><b>Status</b> (enum('SendingOK', 'SendingOKNoReport',
'SendingError', 'DeliveryOK', 'DeliveryFailed', 'DeliveryPending',
'DeliveryUnknown', 'Error'))<br/>
Stav odesílání zprávy. SendingError znamená, že telefonu se
nepodařilo zprávu odeslat, Error indikuje jinou chybu při
zpracovávání zprávy.</p>
<p>- <b>SendingOK</b> - Zpráva byla odeslána, čeká se na
doručenku.<br/>
- <b>SendingOKNoReport</b> - Zpráva byla odeslána bez požadavku na
doručenku.<br/>
- <b>SendingError</b> - Odesílání selhalo.<br/>
- <b>DeliveryOK</b> - Doručenka dorazila a potvrdila úspěšné
doručení.<br/>
- <b>DeliveryFailed</b> - Doručenka dorazila a nahlásila chybu při
doručování.<br/>
- <b>DeliveryPending</b> - Doručenka dorazila a obsahuje informaci
o zpořděném doručení.<br/>
- <b>DeliveryUnknown</b> - Doručenka dorazila, ale informuje o
neznámém stavu.<br/>
- <b>Error</b> - Došlo k nějaké chybě při odesílání (obvykle se
jedná o chybu SMSD).</p>
<p><b>StatusError</b> (integer)<br/>
Stav z doručenky, hodnoty jsou definovány ve specifikaci GSM.</p>
<p><b>Text</b> (text)<br/>
text SMS zprávy v šestnáctkovém formátu</p>
<p><b>DestinationNumber</b> (varchar(20))<br/>
číslo adresáta SMS</p>
<p><b>Coding</b> (enum('Default_No_Compression',
'Unicode_No_Compression', '8bit', 'Default_Compression',
'Unicode_Compression'))<br/>
kódování textu SMS</p>
<p><b>UDH</b> (text)<br/>
hlavička uživatelských dat (UDH) v šestnáctkovém formátu</p>
<p><b>SMSCNumber</b> (varchar(20))<br/>
číslo servisního centra (SMSC), které odeslalo zprávu</p>
<p><b>Class</b> (integer)<br/>
třída SMS nebo -1 (0 je normální SMS, 1 jen pro zobrazení na
displej)</p>
<p><b>TextDecoded</b> (varchar(160))<br/>
text zprávy v &quot;člověkem čitelné&quot; podobě</p>
<p><b>ID</b> (integer unsigned)<br/>
SMS ID</p>
<p><b>SenderID</b> (text)</p>
</dd>
</dl>
<a class="aname" id="lbAG" name="lbAG"/>
<h4>Vkládání zpráv pomocí SQL</h4>
<p><br/>
která instance SMSD odeslala tuto sekvenci</p>
<p><b>SequencePosition</b> (integer)<br/>
pořadí SMS v SMS sekvenci</p>
<p><b>TPMR</b> (integer)<br/>
reference zprávy, podle specifikací GSM</p>
<p><b>RelativeValidity</b> (integer)<br/>
platnost SMS zakódovaná podle GSM specifikací</p>
<p><b>CreatorID</b> (text)<br/>
zkopírováno CreatorID z tabulky outbox, odpovídá PhoneID</p>
<dl compact="compact">
<dt><b>pbk</b></dt>
<dd>
<p>SMSD tuto tabulku v současné době nepoužívá, je zde jen pro
použití v aplikaci.</p>
</dd>
<dt><b>pbk_groups</b></dt>
<dd>
<p>SMSD tuto tabulku v současné době nepoužívá, je zde jen pro
použití v aplikaci.</p>
</dd>
</dl>
<a class="aname" id="lbAH" name="lbAH"/>
<h3>HISTORIE</h3>
<p>Historie verzí schématu:</p>
<p>11 - položky pro ukládání textu zpráv již nejsou omezeny na 160
znaků, ale může se jednat o libovolně dlouhé texty (1.25.92)</p>
<p>10 - DeliveryDateTime je nyní NULL pokud zpráva nebyla doručena,
přidáno několik indexů.</p>
<p>9 - přidána počítadla přijatých a odeslaných zpráv do tabulky
phones</p>
<p>8 - přidána tabulka phones</p>
<p>7 - do tabulek přidáno CreatorID (obsahuje PhoneID, pokud je
nastaveno)</p>
<p><a class="aname" id="lbAI" name="lbAI"/></p>
<h3>PŘÍKLAD</h3>
<p><a class="aname" id="lbAJ" name="lbAJ"/></p>
<h4>Vytváření tabulek</h4>
<p>SQL skripty potřebný pro vytvoření všech tabulek pro většinu
databází je obsažen v dokumentaci Gammu (docs/sql). Ta také
obsahuje pár PHP skriptů pro práci s databází.</p>
<p>Například vytvoření tabulek pro SQLite vypadá následovně:<br/>
</p>
<dl compact="compact">
<dd>
<pre>
sqlite3 smsd.db &lt; docs/sql/sqlite.sql
</pre></dd>
</dl>
<p><a class="aname" id="lbAK" name="lbAK"/></p>
<h4>Vkládání zpráv pomocí SQL</h4>
<p>Pro posílání zpráv buď použijte <a href="../gammu-smsd-inject.1/">gammu-smsd-inject</a>(1), které za vás
udělá veškerou magii, nebo můžete vložit zprávy ručně.
Nejjednodušší je vložit obyčejnou textovou zprávu:</p>
<dl compact="compact">
<dd>
<pre>
INSERT INTO outbox (
    DestinationNumber,
    TextDecoded,
    CreatorID,
    Coding
) VALUES (
    '800123465',
    'This is a SQL test message',
    'Program',
    'Default_No_Compression'
);
</pre></dd>
</dl>
<p><a class="aname" id="lbAL" name="lbAL"/></p>
<h4>Vkládání dlouhých zpráv pomocí SQL</h4>
<p>Vkládání zprávy s více částmi je poněkud náročnější, musíte také
vytvořit UDH hlavičku. Například dlouhá textová zpráva by vypadala
následovně (povšimněte si, že UDH obsahuje počet zpráv a pořadá
zprávy v posledních dvou bajtech, hodnota D3 v příkladu je
identifikace zprávy a může být libovolná):</p>
<dl compact="compact">
<dd>
<pre>
INSERT INTO outbox (
    CreatorID,
    MultiPart,
    DestinationNumber,
    UDH,
    TextDecoded,
    Coding
) VALUES (
    'Gammu 1.23.91',
    'true',
    '123465',
    '050003D30201',
    'Mqukqirip ya konej eqniu rejropocejor hugiygydewl tfej nrupxujob xuemymiyliralj. Te tvyjuh qaxumur ibewfoiws zuucoz tdygu gelum L ejqigqesykl kya jdytbez',
    'Default_No_Compression'
)

INSERT INTO outbox_multipart (
    SequencePosition,
    UDH,
    Class,
    TextDecoded,
    ID,
    Coding
) VALUES (
    2,
    '050003D30202',
    'u xewz qisubevumxyzk ufuylehyzc. Nse xobq dfolizygqysj t bvowsyhyhyemim ovutpapeaempye giuuwbib.',
    &lt;ID_OF_INSERTED_RECORD_IN_OUBOX_TABLE&gt;,
    'Default_No_Compression'
)
</pre></dd>
</dl>
<p><a class="aname" id="lbAM" name="lbAM"/></p>
<h3>DALŠÍ INFORMACE</h3>
Databázové služby: <a href="../gammu-smsd-mysql.7/">gammu-smsd-mysql</a>(7), <a href="../gammu-smsd-pgsql.7/">gammu-smsd-pgsql</a>(7), <a href="../gammu-smsd-dbi.7/">gammu-smsd-dbi</a>(7)
<p><a href="../gammu-smsd.1/">gammu-smsd</a>(1), <a href="../gammu-smsdrc.5/">gammu-smsdrc</a>(5), <a href="../gammu.1/">gammu</a>(1), <a href="../gammurc.5/">gammurc</a>(5) <a class="aname" id="lbAN" name="lbAN"/></p>
<h3>AUTOR</h3>
gammu-smsd a tuto manuálovou stránku napsal Michal Čihař
&lt;<a href="mailto:michal@cihar.com">michal@cihar.com</a>&gt;.
<a class="aname" id="lbAO" name="lbAO"/>
<h3>COPYRIGHT</h3>
Copyright © 2009 Michal Čihař a další autoři. Licence GPLv2: GNU
GPL verze 2 &lt;<a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">http://www.gnu.org/licenses/old-licenses/gpl-2.0.html</a>&gt;<br/>

Tento program je svobodný software; můžete jej šířit a modifikovat.
Není poskytována ŽÁDNÁ ZÁRUKA, v rozsahu jaký je povolen zákonem.
<a class="aname" id="lbAP" name="lbAP"/>
<h3>HLÁŠENÍ CHYB</h3>
Prosím hlašte chyby na &lt;<a href="http://bugs.cihar.com">http://bugs.cihar.com</a>&gt;.
<hr/>
<a class="aname" id="index" name="index"/>
<h3>Index</h3>
<dl>
<dt><a href="#lbAB">JMÉNO</a></dt>
<dt><a href="#lbAC">POPIS</a></dt>
<dd>
<dl>
<dt><a href="#lbAD">Přijímání zpráv</a></dt>
<dt><a href="#lbAE">Odesílání zpráv</a></dt>
<dt><a href="#lbAF">Popis tabulek</a></dt>
<dt><a href="#lbAG">Vkládání zpráv pomocí SQL</a></dt>
</dl>
</dd>
<dt><a href="#lbAH">HISTORIE</a></dt>
<dt><a href="#lbAI">PŘÍKLAD</a></dt>
<dd>
<dl>
<dt><a href="#lbAJ">Vytváření tabulek</a></dt>
<dt><a href="#lbAK">Vkládání zpráv pomocí SQL</a></dt>
<dt><a href="#lbAL">Vkládání dlouhých zpráv pomocí SQL</a></dt>
</dl>
</dd>
<dt><a href="#lbAM">DALŠÍ INFORMACE</a></dt>
<dt><a href="#lbAN">AUTOR</a></dt>
<dt><a href="#lbAO">COPYRIGHT</a></dt>
<dt><a href="#lbAP">HLÁŠENÍ CHYB</a></dt>
</dl>
<hr/>
This document was created by man2html, using the manual
pages.<br/>
Time: 13:38:47 GMT, October 20, 2009
</div>
